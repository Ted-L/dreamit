{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { createComputeRef } from '@glimmer/reference';\nimport { createCapturedArgs, curry, EMPTY_POSITIONAL } from '@glimmer/runtime';\nimport { dict } from '@glimmer/util';\nimport * as vm from '@glimmer/vm';\nimport { setHelperManager, capabilities } from '@ember/helper';\n\n// CurriedType only made available in vm from Ember 5.6.0. Fallback to hardcoded value.\nconst ComponentCurriedType = vm.CurriedType?.Component || 0;\n\n/**\n * Curry a component with named arguments.\n *\n * @param {Component} componentKlass - The component class to curry\n * @param {Object} namedArgs - Named arguments to curry the component with. The set of keys must be static, but the values can be dynamic (e.g. getters, or a Proxy)\n * @param {ApplicationInstance} owner - The owner to use for the curried component\n\n */\nexport default function curryComponent(componentKlass, namedArgs, owner) {\n  if (!namedArgs || !componentKlass || !owner) {\n    throw new Error(\n      'curryComponent requires a component class, named arguments, and an owner',\n    );\n  }\n\n  let namedDict = dict();\n\n  for (const key of Object.keys(namedArgs)) {\n    namedDict[key] = createComputeRef(() => namedArgs[key]);\n  }\n\n  return curry(\n    ComponentCurriedType,\n    componentKlass,\n    owner,\n    createCapturedArgs(namedDict, EMPTY_POSITIONAL),\n    false,\n  );\n}\n\n/**\n * Like the default function helper manager,\n * but also passes the owner as a final argument.\n */\nclass CurryComponentHelperManager {\n  capabilities = capabilities('3.23', {\n    hasValue: true,\n    hasDestroyable: false,\n    hasScheduledEffect: false,\n  });\n\n  constructor(owner) {\n    this.owner = owner;\n  }\n\n  createHelper(fn, args) {\n    return { fn, args };\n  }\n\n  getValue({ fn, args }) {\n    return fn(...args.positional, this.owner);\n  }\n}\n\nsetHelperManager(\n  (owner) => new CurryComponentHelperManager(owner),\n  curryComponent,\n);\n"],"names":["ComponentCurriedType","vm","CurriedType","Component","curryComponent","componentKlass","namedArgs","owner","Error","namedDict","dict","key","Object","keys","createComputeRef","curry","createCapturedArgs","EMPTY_POSITIONAL","CurryComponentHelperManager","capabilities","hasValue","hasDestroyable","hasScheduledEffect","constructor","createHelper","fn","args","getValue","positional","setHelperManager"],"mappings":";;;;;;AAMA;AACA,MAAMA,oBAAoB,GAAGC,EAAE,CAACC,WAAW,EAAEC,SAAS,IAAI,CAAC;;AAE3D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACe,SAASC,cAAcA,CAACC,cAAc,EAAEC,SAAS,EAAEC,KAAK,EAAE;EACvE,IAAI,CAACD,SAAS,IAAI,CAACD,cAAc,IAAI,CAACE,KAAK,EAAE;AAC3C,IAAA,MAAM,IAAIC,KAAK,CACb,0EACF,CAAC;AACH;AAEA,EAAA,IAAIC,SAAS,GAAGC,IAAI,EAAE;EAEtB,KAAK,MAAMC,GAAG,IAAIC,MAAM,CAACC,IAAI,CAACP,SAAS,CAAC,EAAE;IACxCG,SAAS,CAACE,GAAG,CAAC,GAAGG,gBAAgB,CAAC,MAAMR,SAAS,CAACK,GAAG,CAAC,CAAC;AACzD;AAEA,EAAA,OAAOI,KAAK,CACVf,oBAAoB,EACpBK,cAAc,EACdE,KAAK,EACLS,kBAAkB,CAACP,SAAS,EAAEQ,gBAAgB,CAAC,EAC/C,KACF,CAAC;AACH;;AAEA;AACA;AACA;AACA;AACA,MAAMC,2BAA2B,CAAC;AAChCC,EAAAA,YAAY,GAAGA,YAAY,CAAC,MAAM,EAAE;AAClCC,IAAAA,QAAQ,EAAE,IAAI;AACdC,IAAAA,cAAc,EAAE,KAAK;AACrBC,IAAAA,kBAAkB,EAAE;AACtB,GAAC,CAAC;EAEFC,WAAWA,CAAChB,KAAK,EAAE;IACjB,IAAI,CAACA,KAAK,GAAGA,KAAK;AACpB;AAEAiB,EAAAA,YAAYA,CAACC,EAAE,EAAEC,IAAI,EAAE;IACrB,OAAO;MAAED,EAAE;AAAEC,MAAAA;KAAM;AACrB;AAEAC,EAAAA,QAAQA,CAAC;IAAEF,EAAE;AAAEC,IAAAA;AAAK,GAAC,EAAE;IACrB,OAAOD,EAAE,CAAC,GAAGC,IAAI,CAACE,UAAU,EAAE,IAAI,CAACrB,KAAK,CAAC;AAC3C;AACF;AAEAsB,gBAAgB,CACbtB,KAAK,IAAK,IAAIW,2BAA2B,CAACX,KAAK,CAAC,EACjDH,cACF,CAAC;;;;"}